"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getWindowHandles;

var _v = _interopRequireDefault(require("uuid/v4"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

async function getWindowHandles() {
  let newPages = await this.browser.pages();
  const stalePageIds = [];
  this.windows.forEach((page, id) => {
    if (newPages.includes(page)) {
      newPages = newPages.filter(newPage => page !== newPage);
    } else {
      stalePageIds.push(id);
    }
  });
  stalePageIds.forEach(pageId => this.windows.delete(pageId));
  newPages.forEach(page => this.windows.set((0, _v.default)(), page));
  return Array.from(this.windows.keys());
}